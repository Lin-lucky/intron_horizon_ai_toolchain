<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>常见系统命令</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <!-- bundled in js (rollup iife) -->
      <!-- <link rel="stylesheet" href="../_static/theme.css"> -->
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/css/theme.css " type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../_static/theme-vendors.js"></script> -->
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="开发平台概述" href="../source_doc/x3_ddk_user_guide.html" />
  <link rel="prev" title="固件升级手册" href="xj3_board_update_guide.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">地平线 X3J3 芯片开发手册</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

            
          </navlinks><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">整体概述</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">芯片介绍</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="x3_soc_user_guide.html" class="reference internal ">旭日X3芯片概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_soc_contrast.html" class="reference internal ">X3与J3差异描述</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">开发套件介绍</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="xj3_board_overview.html" class="reference internal ">开发套件概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="x3_sdb_overview.html" class="reference internal ">X3 SDB生态套件</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_board_update_guide.html" class="reference internal ">固件升级手册</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">常见系统命令</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#id2" class="reference internal">1. 系统版本检查</a></li>
                
                  <li class="toctree-l2"><a href="#hrut-utilities" class="reference internal">2. hrut_utilities 工具集</a></li>
                
                  <li class="toctree-l2"><a href="#thermal" class="reference internal">3. Thermal 配置使用指南</a></li>
                
                  <li class="toctree-l2"><a href="#cpu" class="reference internal">4. CPU 调频说明</a></li>
                
              </ul>
            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">天工开物开发平台</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../source_doc/x3_ddk_user_guide.html" class="reference internal ">开发平台概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_ddk_quick_start.html" class="reference internal ">开发环境搭建</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_ddk_sample.html" class="reference internal ">应用开发示例</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../source_doc/x3_ddk_docs.html" class="reference internal ">附录：开发手册</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">其他</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="other_sources.html" class="reference internal ">社区资源索引</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>常见系统命令</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="xj3_board_update_guide.html"
       title="previous chapter">← 固件升级手册</a>
  </li>
  <li class="next">
    <a href="../source_doc/x3_ddk_user_guide.html"
       title="next chapter">开发平台概述 →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <div class="section" id="id1">
<h1>常见系统命令<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>1. 系统版本检查<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>使用以下命令检查当前系统的版本。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat /etc/version
</pre></div>
</div>
</div>
<div class="section" id="hrut-utilities">
<h2>2. <code class="docutils literal notranslate"><span class="pre">hrut_utilities</span></code> 工具集<a class="headerlink" href="#hrut-utilities" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">hrut_utilities</span></code> 是一套用于芯片侧采集/设置系统信息的工具集，主要包括板卡 ID 查询/设置，BPU 状态监控，DDR 状态监控，
温度传感器读数及 CPU/BPU 频率实时信息查询，IP/MAC 地址查询与设置等，具体说明如下：</p>
<div class="section" id="hrut-boardid">
<h3>2.1 <code class="docutils literal notranslate"><span class="pre">hrut_boardid</span></code><a class="headerlink" href="#hrut-boardid" title="Permalink to this headline">¶</a></h3>
<p>用于获取/设置开发板 <code class="docutils literal notranslate"><span class="pre">Boardid</span></code>。其中具体 ID 定义为:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>含义</p></th>
<th class="head"><p>长度</p></th>
<th class="head"><p>取值范围</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Model</p></td>
<td><p>DDR 厂商</p></td>
<td><p>4Bits</p></td>
<td><p>0x0:自动检测；0x1:海力士；0x2:镁光；0x3:三星</p></td>
</tr>
<tr class="row-odd"><td><p>DDR Type</p></td>
<td><p>DDR 类型</p></td>
<td><p>4Bits</p></td>
<td><p>0x0:自动检测；0x1: LPDDR4；0x2: LPDDR4X；0x3: DDR4；0x4: DDR3L</p></td>
</tr>
<tr class="row-even"><td><p>Frequency</p></td>
<td><p>DDR 频率</p></td>
<td><p>4Bits</p></td>
<td><p>0x0:自动检测；0x1: 667；0x2: 1600；0x3: 2133；0x4: 2666；0x5: 3200；0x6: 3733；0x7: 4266</p></td>
</tr>
<tr class="row-odd"><td><p>Capacity</p></td>
<td><p>DDR 容量</p></td>
<td><p>4Bits</p></td>
<td><p>0x0:自动检测；0x1: 1GB；0x2: 2GB；0x3: 4GB</p></td>
</tr>
<tr class="row-even"><td><p>ECC</p></td>
<td><p>ECC 配置</p></td>
<td><p>4Bits</p></td>
<td><p>0x0: Default；0x1: inline ECC All；0x2: inline ECC option1；0x3: inline ECC option2</p></td>
</tr>
<tr class="row-odd"><td><p>SOM Type</p></td>
<td><p>SOM 类型</p></td>
<td><p>4Bits</p></td>
<td><p>0x0:自动检测；0x1: X3；0x2: J3</p></td>
</tr>
<tr class="row-even"><td><p>Alternative</p></td>
<td><p>额外设置</p></td>
<td><p>4Bits</p></td>
<td><p>0x0: Default；0x1: Config1</p></td>
</tr>
<tr class="row-odd"><td><p>Board Type</p></td>
<td><p>底板类型</p></td>
<td><p>4Bits</p></td>
<td><p>0x1: X3 DVB；0x2: J3 DVB；0x3: CVB</p></td>
</tr>
</tbody>
</table>
<p>命令与示例如下所示：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Example: hrut_boardid g
Options:
  g get board id<span class="o">(</span>veeprom<span class="o">)</span>
  s <span class="nb">set</span> board id<span class="o">(</span>veeprom<span class="o">)</span>
  G get board id<span class="o">(</span>bootinfo<span class="o">)</span>
  S <span class="nb">set</span> board id<span class="o">(</span>bootinfo<span class="o">)</span>
  c clear board id<span class="o">(</span>veeprom<span class="o">)</span>
  C clear board id<span class="o">(</span>bootinfo<span class="o">)</span>
  h  display this <span class="nb">help</span> text

// 读取 boardid<span class="o">(</span>veeprom<span class="o">)</span>
root@x3dvbx3-hynix1G-2666:~# hrut_boardid g
<span class="m">11410101</span>

// 设置 boardid<span class="o">(</span>veeprom<span class="o">)</span>
root@x3dvbx3-hynix1G-2666:~# hrut_boardid s <span class="m">11410101</span>
<span class="nb">set</span> board <span class="nv">id</span> <span class="o">=</span> <span class="m">11410101</span>

// 读取 boardid<span class="o">(</span>bootinfo<span class="o">)</span>
root@x3dvbx3-hynix1G-2666:~# hrut_boardid G
<span class="m">00</span>

// 设置 boardid<span class="o">(</span>bootinfo<span class="o">)</span>
root@x3dvbx3-hynix1G-2666:~# hrut_boardid S <span class="m">11410101</span>
change board id from <span class="m">0</span> to <span class="m">11410101</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>注意 <code class="docutils literal notranslate"><span class="pre">Boardid</span></code> 会影响到启动时，SOM板的初始化，请谨慎设置。</p>
</div>
</div>
<div class="section" id="hrut-bpuprofile">
<h3>2.2 <code class="docutils literal notranslate"><span class="pre">hrut_bpuprofile</span></code><a class="headerlink" href="#hrut-bpuprofile" title="Permalink to this headline">¶</a></h3>
<p>用于设置 BPU 状态，例如调节每个 BPU 频率、电源上电/掉电、时钟打开/关闭，脚本帮助文档如下：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile
bpu core error,you should <span class="k">select</span> <span class="m">0</span>/1/2
BPU PROFILE HELP INFORMATION
&gt;&gt;&gt; -b/--bpu         <span class="o">[</span>BPU CORE,0--bpu0,1--bpu1,2--ALL BPU<span class="o">]</span> <span class="o">(</span>required<span class="o">)</span>
&gt;&gt;&gt; -p/--power       <span class="o">[</span>POWER OFF/ON,0--OFF,1--ON<span class="o">]</span>
&gt;&gt;&gt; -c/--clock       <span class="o">[</span>CLOCK OFF/ON,0--OFF,1--ON<span class="o">]</span>
&gt;&gt;&gt; -e/--enabletime  <span class="o">[</span>GET FC TIME/ON,0--OFF,1--ON<span class="o">]</span>
&gt;&gt;&gt; -t/--time        <span class="o">[</span>GET FC TIME,NO ARGUMENT<span class="o">]</span>
&gt;&gt;&gt; -f/--frq         <span class="o">[</span>SET BPU FREQUENCY,ARGUMENT:N<span class="o">]</span>
&gt;&gt;&gt; -r/--ratio       <span class="o">[</span>BPU RATIO,N--N TIMES,0--FOREVER<span class="o">]</span>
</pre></div>
</div>
<p>常见使用方式包括：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 查看 <span class="m">2</span> 个 bpu 的使用率
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">2</span> -r <span class="m">0</span>
BPU   RATIO    FREE QUEUE
<span class="m">0</span>     <span class="m">99</span>%       <span class="m">1020</span>
<span class="m">1</span>     <span class="m">99</span>%       <span class="m">1024</span>

// 设置 bpu0 的频率为 400M
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">0</span> -f <span class="m">400000000</span>

// bpu1 掉电
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">1</span> -p <span class="m">0</span>

// 查看 <span class="nb">fc</span> 执行时间
// 首先开始记录 <span class="nb">fc</span> 执行时间功能
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">2</span> -e <span class="m">1</span>
// 查看记录的 <span class="nb">fc</span> 执行时间
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">2</span> -t
// 不使用该功能之后，可以将其关闭
root@x3sdbx3-samsung2G-3200:~# hrut_bpuprofile -b <span class="m">2</span> -e <span class="m">0</span>
</pre></div>
</div>
</div>
<div class="section" id="hrut-mac">
<h3>2.3 <code class="docutils literal notranslate"><span class="pre">hrut_mac</span></code><a class="headerlink" href="#hrut-mac" title="Permalink to this headline">¶</a></h3>
<p>用于设置当前板子网卡 MAC 相关参数</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 写入
hrut_mac s aa:bb:cc:dd:ee:ff

// 读取
hrut_mac g
</pre></div>
</div>
</div>
<div class="section" id="hrut-somstatus">
<h3>2.4 <code class="docutils literal notranslate"><span class="pre">hrut_somstatus</span></code><a class="headerlink" href="#hrut-somstatus" title="Permalink to this headline">¶</a></h3>
<p>用于实时查询温度传感器读数及 CPU/BPU 频率实时信息</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>root@x3sdbx3-samsung2G-3200:~# <span class="nv">hrut_somstatus</span>
<span class="o">=====================</span><span class="nv">1</span><span class="o">=====================</span>
temperature--&gt;
    CPU      : <span class="m">72</span>.8 <span class="o">(</span>C<span class="o">)</span>
cpu frequency--&gt;
      min       cur     max
    cpu0: <span class="m">240000</span>    <span class="m">1200000</span> <span class="m">1200000</span>
    cpu1: <span class="m">240000</span>    <span class="m">1200000</span> <span class="m">1200000</span>
    cpu2: <span class="m">240000</span>    <span class="m">1200000</span> <span class="m">1200000</span>
    cpu3: <span class="m">240000</span>    <span class="m">1200000</span> <span class="m">1200000</span>
bpu status information----&gt;
      min        cur             max             ratio
    bpu0: <span class="m">400000000</span> <span class="m">1000000000</span>      <span class="m">1000000000</span>      <span class="m">100</span>
    bpu1: <span class="m">400000000</span> <span class="m">1000000000</span>      <span class="m">1000000000</span>      <span class="m">100</span>
</pre></div>
</div>
</div>
<div class="section" id="hurt-ipfull">
<h3>2.5 <code class="docutils literal notranslate"><span class="pre">hurt_ipfull</span></code><a class="headerlink" href="#hurt-ipfull" title="Permalink to this headline">¶</a></h3>
<p>用于设置板子 IP 相关参数。配置完成，板子下次上电会自动配置 IP，MASK，GATEWAY 信息。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 写入
// hrut_ipfull s IP MASK GATEWAY
root@x3sdbx3-samsung2G-3200:~# hrut_ipfull s <span class="m">192</span>.168.1.10 <span class="m">255</span>.255.255.0 <span class="m">192</span>.168.1.255

// 读取
root@x3sdbx3-samsung2G-3200:~# hrut_ipfull g
<span class="nv">ip</span><span class="o">=</span><span class="m">192</span>.168.1.10
<span class="nv">mask</span><span class="o">=</span><span class="m">255</span>.255.255.0
<span class="nv">gw</span><span class="o">=</span><span class="m">192</span>.168.1.255

// 清除
// 一旦清除后，板子下次上电会使用默认地址 <span class="m">192</span>.168.1.10
root@x3sdbx3-samsung2G-3200:~# hrut_ipfull c
</pre></div>
</div>
</div>
<div class="section" id="hrut-ddr">
<h3>2.6 <code class="docutils literal notranslate"><span class="pre">hrut_ddr</span></code><a class="headerlink" href="#hrut-ddr" title="Permalink to this headline">¶</a></h3>
<p>设置 DDR Qos，查询 DDR 各个端口的带宽，详细请参考 <cite>ddkdocdsp</cite> 目录下的《X3平台系统软件用户手册》和《J3平台系统软件用户手册》。</p>
</div>
</div>
<div class="section" id="thermal">
<h2>3. Thermal 配置使用指南<a class="headerlink" href="#thermal" title="Permalink to this headline">¶</a></h2>
<p>在 x3 里面一共有三个 cooling(降温)设备，分别为 <cite>cooling_device0：cnn0</cite>，<cite>cooling_device1: cnn1</cite>，<cite>cooling_device2: cpu</cite>。
目前对于这些设备采用默认降温策略为 <code class="docutils literal notranslate"><span class="pre">step_wise</span></code>，你可以根据你的需求进行调整。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 查询当前策略
cat /sys/class/thermal/thermal_zone0/policy

// 支持的策略类型为 “user_space”、“step_wise”。
cat /sys/class/thermal/thermal_zone0/available_policies

// 切换到 user_space
<span class="nb">echo</span> user_space &gt; /sys/class/thermal/thermal_zone0/policy
ls -l /sys/devices/virtual/thermal/thermal_zone0
// 可看到有三个 trip_point。目前默认选择的 trip_point 是 trip_point_1_temp<span class="o">(</span>温度是 <span class="m">75</span> 度<span class="o">)</span>。
// 如果想要调整 trip_point_1_temp 温度值
<span class="nb">echo</span> <span class="m">85000</span> &gt; /sys/devices/virtual/thermal/thermal_zone0/trip_point_1_temp
</pre></div>
</div>
</div>
<div class="section" id="cpu">
<h2>4. CPU 调频说明<a class="headerlink" href="#cpu" title="Permalink to this headline">¶</a></h2>
<p>CPU 的调频策略默认是 “ondemand”，会根据负载自动调整频率。在作某些性能测试时，可以把 CPU 频率固定在最高值或设定为某个值。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// CPU 频率固定在最高值:
<span class="nb">echo</span> performance &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor

// 固定为某个值:
// 首先，设置 userspace 为当前调频策略:
<span class="nb">echo</span> userspace&gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
// 查看有哪些频率:
cat /sys/devices/system/cpu/cpufreq/policy0/scaling_available_frequencies
// 设为 500M:
<span class="nb">echo</span> <span class="m">500000</span> &gt; /sys/devices/system/cpu/cpufreq/policy0/scaling_setspeed

// 查看 CPU 当前频率:
cat /sys/devices/system/cpu/cpufreq/policy0/cpuinfo_cur_freq
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="xj3_board_update_guide.html"
       title="previous chapter">← 固件升级手册</a>
  </li>
  <li class="next">
    <a href="../source_doc/x3_ddk_user_guide.html"
       title="next chapter">开发平台概述 →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2021, Horizon Robotics.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>