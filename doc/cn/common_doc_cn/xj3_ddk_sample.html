<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>应用开发示例</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <!-- bundled in js (rollup iife) -->
      <!-- <link rel="stylesheet" href="../_static/theme.css"> -->
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/css/theme.css " type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../_static/theme-vendors.js"></script> -->
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="附录：开发手册" href="../source_doc/x3_ddk_docs.html" />
  <link rel="prev" title="开发环境搭建" href="xj3_ddk_quick_start.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">地平线 X3J3 芯片开发手册</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

            
          </navlinks><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">整体概述</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">芯片介绍</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="x3_soc_user_guide.html" class="reference internal ">旭日X3芯片概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_soc_contrast.html" class="reference internal ">X3与J3差异描述</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">开发套件介绍</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="xj3_board_overview.html" class="reference internal ">开发套件概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="x3_sdb_overview.html" class="reference internal ">X3 SDB生态套件</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_board_update_guide.html" class="reference internal ">固件升级手册</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_board_command.html" class="reference internal ">常见系统命令</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">天工开物开发平台</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="../source_doc/x3_ddk_user_guide.html" class="reference internal ">开发平台概述</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="xj3_ddk_quick_start.html" class="reference internal ">开发环境搭建</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">应用开发示例</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#id2" class="reference internal">1. 环境确认</a></li>
                
                  <li class="toctree-l2"><a href="#id3" class="reference internal">2. 样例编译</a></li>
                
                  <li class="toctree-l2"><a href="#id4" class="reference internal">3. 上板部署</a></li>
                
                  <li class="toctree-l2"><a href="#id5" class="reference internal">4. 执行与可视化</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="../source_doc/x3_ddk_docs.html" class="reference internal ">附录：开发手册</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#x3j3">其他</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="other_sources.html" class="reference internal ">社区资源索引</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>应用开发示例</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="xj3_ddk_quick_start.html"
       title="previous chapter">← 开发环境搭建</a>
  </li>
  <li class="next">
    <a href="../source_doc/x3_ddk_docs.html"
       title="next chapter">附录：开发手册 →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <div class="section" id="id1">
<h1>应用开发示例<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>在完成开发板的上电，镜像编译，板卡系统升级以及开发环境的搭建以后，下一步就可以将 <code class="docutils literal notranslate"><span class="pre">ddk/samples</span></code> 目录下示例跑起来。
本文将围绕多任务感知参考解决方案 <code class="docutils literal notranslate"><span class="pre">ddk/samples/solution_zoo/multitask_perception_solution</span></code> 来介绍如何快速跑通开发板的全链路流程。</p>
<div class="section" id="id2">
<h2>1. 环境确认<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>交叉编译环境已经安装</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>work@work-server:~$ ll /opt/gcc-linaro-6.5.0-2018.12-x86_64_aarch64-linux-gnu
total <span class="m">36</span>
drwxr-xr-x <span class="m">7</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> aarch64-linux-gnu
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> bin
-rw-r--r-- <span class="m">1</span> root root <span class="m">9489</span> 10月 <span class="m">15</span>  <span class="m">2019</span> gcc-linaro-6.5.0-2018.12-linux-manifest.txt
drwxr-xr-x <span class="m">3</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> include
drwxr-xr-x <span class="m">3</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> lib
drwxr-xr-x <span class="m">3</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> libexec
drwxr-xr-x <span class="m">8</span> root root <span class="m">4096</span> 10月 <span class="m">15</span>  <span class="m">2019</span> share
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">ddk/package/host</span></code> package已经安装</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>~/.horizon/ddk/
├── xj3_aarch64
│   ├── appsdk
│   │   └── appuser
│   ├── appsdk_1.9.0.tar.gz
│   ├── bpu_predict
│   │   ├── include
│   │   └── lib
│   ├── bpu_predict_1.10.2.tar.gz
│   ├── dnn
│   │   ├── include
│   │   └── lib
│   ├── dnn_1.1.2a.tar.gz
│   ├── hobotsdk
│   │   ├── include
│   │   └── lib
│   ├── hobotsdk_1.9.13.tar.gz
│   ├── image_utils
│   │   ├── include
│   │   └── lib
│   ├── image_utils_1.1.10c.tar.gz
│   ├── model_inference
│   │   ├── include
│   │   └── lib
│   ├── model_inference_1.0.13.tar.gz
│   ├── rtsp_server
│   │   ├── include
│   │   └── lib
│   ├── rtsp_server_1.0.13.tar.gz
│   ├── uvc_server
│   │   ├── include
│   │   └── lib
│   ├── uvc_server_1.0.13.tar.gz
│   ├── video_source
│   │   ├── include
│   │   └── lib
│   ├── video_source_1.0.13.tar.gz
│   ├── xproto
│   │   ├── include
│   │   └── lib
│   ├── xproto_1.1.10c.tar.gz
│   ├── xstream
│   │   ├── include
│   │   └── lib
│   └── xstream_1.1.10c.tar.gz
└── xj3_x86_64_gcc_4.8.5
    ├── bpu_predict
    │   ├── include
    │   └── lib
    ├── bpu_predict_1.10.2.tar.gz
    ├── dnn_x86
    │   ├── include
    │   └── lib
    ├── dnn_x86_1.1.2a.tar.gz
    ├── hobotsdk
    │   ├── include
    │   └── lib
    ├── hobotsdk_1.9.13.tar.gz
    ├── xproto
    │   ├── include
    │   └── lib
    ├── xproto_1.1.10c.tar.gz
    ├── xstream
    │   ├── include
    │   └── lib
    └── xstream_1.1.10c.tar.gz
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>开发板和开发机器连通，并完成配套的系统镜像升级，我们这里示例是基于0207进行验证。</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>root@x3sdbx3-samsung2G-3200:~# cat /etc/version
LNX_PL2.0_WB_20210207 release
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">ddk/package/board</span></code> 板端附加工具已经安装。</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 将ddk/package/board安装到开发板子
work@work-server:/ddk/package/board$ sh install.sh <span class="m">10</span>.64.35.206

// 验证安装成功
root@x3sdbx3-samsung2G-3200:/userdata/.horizon/# ll
drwxr-xr-x    <span class="m">6</span> root     root          <span class="m">4096</span> Jan  <span class="m">1</span> <span class="m">08</span>:14 ai_express_webservice_display
-rwx------    <span class="m">1</span> root     root      <span class="m">10424232</span> Jan  <span class="m">1</span> <span class="m">08</span>:15 hrt_bin_dump
-rwx------    <span class="m">1</span> root     root      <span class="m">15380352</span> Jan  <span class="m">1</span> <span class="m">08</span>:15 hrt_model_exec
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>2. 样例编译<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>多任务感知参考解决方案内置了丰富的人脸人体感知相关的算法，并且以源码方式进行提供。</p>
<p>使用之前，首先需要进行编译，进入 <code class="docutils literal notranslate"><span class="pre">ddk/samples/solution_zoo/multitask_perception_solution</span></code> 目录，执行 <code class="docutils literal notranslate"><span class="pre">build_and_deploy.sh</span></code> 即可以完成编译。</p>
<p>一旦正确完成编译，会在 <code class="docutils literal notranslate"><span class="pre">multitask_perception_solution</span></code> 目录下，新增 <code class="docutils literal notranslate"><span class="pre">/deploy</span></code> 目录。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>work@work-server:/multitask_perception_solution/deploy$ ll
total <span class="m">44</span>
drwxr-xr-x <span class="m">6</span> work work  <span class="m">4096</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 configs
drwxrwxr-x <span class="m">2</span> work work  <span class="m">4096</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 lib
drwxr-xr-x <span class="m">2</span> work work  <span class="m">4096</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 models
drwxrwxr-x <span class="m">3</span> work work  <span class="m">4096</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 multitask_perception
-rwxr-xr-x <span class="m">1</span> work work <span class="m">12366</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 run_body.sh
-rwxr-xr-x <span class="m">1</span> work work <span class="m">11637</span> 4月  <span class="m">13</span> <span class="m">11</span>:32 run_face_recog.sh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>首次编译，由于会涉及较多的依赖库的编译，整体编译速度会较慢，但是在后续做了源码修改以后，
再次执行 <code class="docutils literal notranslate"><span class="pre">build_and_deploy.sh</span></code> 相比会有很大的速度提升。</p>
</div>
</div>
<div class="section" id="id4">
<h2>3. 上板部署<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>多任务感知参考解决方案解决方案部署，非常简单，你只需要将 <code class="docutils literal notranslate"><span class="pre">multitask_perception_solution/deploy</span></code> 部署到开发板的 <code class="docutils literal notranslate"><span class="pre">/userdata</span></code> 目录下即可以。</p>
<p>你可以采用scp/tftp/nfs等方式来进行开发机与开发板之间的数据传输，本文采用scp方式进行实现。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>// 将/deploy安装到开发板
work@work-server:/solution_zoo/multitask_perception_solution$ scp -r deploy root@10.64.35.206:/userdata/

// 在开发板上验证安装成功
root@x3sdbx3-samsung2G-3200:/userdata/deploy# ll
drwxr-xr-x    <span class="m">6</span> root     root          <span class="m">4096</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 configs
drwxrwxr-x    <span class="m">2</span> root     root          <span class="m">4096</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 lib
drwxr-xr-x    <span class="m">2</span> root     root          <span class="m">4096</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 models
drwxrwxr-x    <span class="m">3</span> root     root          <span class="m">4096</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 multitask_perception
-rwx------    <span class="m">1</span> root     root         <span class="m">12366</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 run_body.sh
-rwx------    <span class="m">1</span> root     root         <span class="m">11637</span> Jan  <span class="m">1</span> <span class="m">08</span>:29 run_face_recog.sh
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>4. 执行与可视化<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">/userdata/deploy</span></code> 目录下提供了 <code class="docutils literal notranslate"><span class="pre">run_body.sh</span></code> 和 <code class="docutils literal notranslate"><span class="pre">run_face_recog.sh</span></code> 两个脚本，支持分别运行人体感知示例和人脸感知示例。</p>
<p>运行过程中，需要根据你的开发板外接的摄像头类型来进行实现，我们这里采用的一个奥速的1080p的USB摄像头。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root@x3sdbx3-samsung2G-3200:/userdata/deploy# sh run_face_recog.sh
chmod: start_nginx.sh: No such file or directory
sh: can&#39;t open &#39;start_nginx.sh&#39;: No such file or directory
Choose lunch x3 vio type menu...pick a combo:
        1. single cam
        2. single feedback
Which would you like?
1
You choose 1:single_cam
Choose lunch single cam sensor menu...pick a combo:
        1. single camera: os8a10, 2160P
        2. single camera: os8a10, 1080P
        3. single camera: usb_cam, 1080P
        4. single camera: f37_1080p, 1080P
Which would you like?
3
You choose 3:usb_cam
vio_mode: usb_cam
vio_pipe_file: configs/vio/x3dev/iot_vio_x3_usb_cam_1080p.json
usb_cam start, default resolution 1080P...
/usr/bin/adbd is not runnning
vio_cfg_file: ./configs/vio_config.json.x3dev.cam
turn on mallopt
use bpu native engine
[1970-01-01 08:35:32 INFO 548044893280 hr_api.cpp:479] HorizonRT version = 1.5.1
[1970-01-01 08:35:32 INFO 548044893280 hr_api.cpp:484] hbrt version = 3.12.2
</pre></div>
</div>
<p>一旦运行起来，你就可以在同一个网段的开发机上，访问 <code class="docutils literal notranslate"><span class="pre">http://[开发板]</span></code> 地址来可视化执行输出的结果，我们这里访问的 <code class="docutils literal notranslate"><span class="pre">http://10.64.35.206</span></code>。</p>
<p>整体效果如下所示：</p>
<a class="reference internal image-reference" href="../_images/demo.png"><img alt="../_images/demo.png" src="../_images/demo.png" style="width: 767.4px; height: 462.0px;" /></a>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="xj3_ddk_quick_start.html"
       title="previous chapter">← 开发环境搭建</a>
  </li>
  <li class="next">
    <a href="../source_doc/x3_ddk_docs.html"
       title="next chapter">附录：开发手册 →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2021, Horizon Robotics.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>